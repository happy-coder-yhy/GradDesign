# Excel文件上传功能说明

## 功能概述

A*算法的"多航班调度"模块现在支持两种数据来源：
1. **随机生成**：系统自动生成随机航班数据
2. **上传文件**：用户上传Excel文件，系统解析并提取航班信息

## Excel文件格式要求

### 必填字段

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| flight_id | 文本 | 航班ID | FL1001 |
| aircraft_type | 文本 | 机型 | A320, B737 |
| operation | 文本 | 操作类型 | departure（离港）或 arrival（进港） |
| scheduled_time | 日期时间 | 计划时间 | 2024-01-20 14:00:00 |
| start_node_id | 数字 | 起始节点ID | 1, 2, 3... |
| end_node_id | 数字 | 目标节点ID | 100, 200... |
| priority | 数字 | 优先级 | 1-10（数字越大优先级越高） |

### Excel示例数据

```
flight_id  | aircraft_type | operation   | scheduled_time       | start_node_id | end_node_id | priority
-----------|---------------|-------------|----------------------|---------------|--------------|----------
FL1001     | A320          | departure   | 2024-01-20 14:00:00  | 1             | 100          | 5
FL1002     | B737          | arrival     | 2024-01-20 14:05:00  | 200           | 5            | 7
FL1003     | A330          | departure   | 2024-01-20 14:10:00  | 3             | 100          | 3
```

## 使用步骤

### 1. 切换到文件上传模式
- 在A*算法页面，点击"多航班调度"标签
- 点击"上传文件"选项卡

### 2. 准备Excel文件
- 确保Excel文件包含所有必填字段
- 字段名称必须与上述表格完全一致（区分大小写）
- operation字段只能是"departure"或"arrival"
- 时间格式必须是：YYYY-MM-DD HH:MM:SS
- 节点ID和优先级必须是数字

### 3. 上传文件
- 点击"选择文件"按钮
- 选择本地Excel文件（支持.xlsx和.xls格式）
- 文件名会显示在按钮旁边

### 4. 提取航班信息
- 点击"提取航班信息"按钮
- 系统会验证数据格式
- 如果成功，会显示"成功提取 X 条航班信息！"
- 如果失败，会显示具体的错误信息

### 5. 开始调度
- 提取成功后，航班信息会显示在页面下方
- 选择调度策略（FCFS、优先级调度、时间窗调度）
- 点击"开始调度"按钮
- 在画布中查看调度结果可视化

## 注意事项

1. **文件格式**：只支持.xlsx和.xls格式的Excel文件
2. **字段名称**：必须使用英文字段名，且与要求完全一致
3. **数据验证**：系统会自动验证所有数据的格式和有效性
4. **错误提示**：如果数据有误，系统会显示具体的错误行和错误原因
5. **数据覆盖**：上传新文件会覆盖之前的航班数据

## 常见问题

### Q: 提示"缺少字段"怎么办？
A: 检查Excel文件的第一行是否包含所有必填字段名，确保拼写正确。

### Q: 时间格式错误怎么办？
A: 确保时间格式为"2024-01-20 14:00:00"，使用24小时制。

### Q: operation字段应该填什么？
A: 只能填"departure"（离港）或"arrival"（进港），不要使用中文或其他值。

### Q: 节点ID应该填什么？
A: 填写西安机场路网中的节点ID数字。可以参考系统随机生成的数据来了解有效的节点ID范围。

### Q: 最多支持多少条航班数据？
A: 建议不超过50条，过多可能导致可视化效果不佳。

## 创建Excel模板

你可以按照以下步骤创建Excel模板：

1. 打开Excel或WPS表格
2. 在第一行输入字段名（从A列到G列）：
   - A1: flight_id
   - B1: aircraft_type
   - C1: operation
   - D1: scheduled_time
   - E1: start_node_id
   - F1: end_node_id
   - G1: priority
3. 从第二行开始输入数据
4. 保存为.xlsx或.xls格式

## 示例数据下载

你可以复制以下数据到Excel中作为测试：

```csv
flight_id,aircraft_type,operation,scheduled_time,start_node_id,end_node_id,priority
FL1001,A320,departure,2024-01-20 14:00:00,1,100,5
FL1002,B737,arrival,2024-01-20 14:05:00,200,5,7
FL1003,A330,departure,2024-01-20 14:10:00,3,100,3
FL1004,B787,arrival,2024-01-20 14:15:00,201,8,6
FL1005,A350,departure,2024-01-20 14:20:00,2,100,8
FL1006,B777,arrival,2024-01-20 14:25:00,202,6,4
```

将上述CSV数据粘贴到Excel中，然后保存为Excel格式即可使用。
